# BSL-Doc

BSL-Doc — это инструмент для автоматической генерации документации на основе исходных кодов конфигурации 1С:Предприятие.
Он поддерживает работу с исходниками как в формате **конфигуратора**, так и в формате **EDT**.
Для анализа исходных кодов используются компоненты [bsl-language-server](https://github.com/1c-syntax/bsl-language-server), включая [bsl-parser](https://github.com/1c-syntax/bsl-parser) для работы с модулями и [mdclasses](https://github.com/1c-syntax/mdclasses) для чтения дерева метаданных.

## Возможности

- Генерация документации в форматах Markdown, ConfluenceMarkdown и Docusaurus.
- Поддержка фильтрации по подсистемам и регионам.
- Возможность объединения с ручной документацией.
- Гибкая настройка иерархии и структуры выходной документации.

## Требования

* java version 17

## Установка

* Скачайте jar файл со страницы [релизов](https://github.com/1CDevFlow/BSL-Doc/releases)

## Запуск

### Параметры запуска

```bash
bsldoc --format=<Docusaurus, Markdown> --only-subsystems=<root subsystems list> --regions=<regions filter> source destination
```

| Параметр        | Описание                                                                                                                           | Доступные значения                       | Значение по умолчанию        | Файл          | Cli               |
|-----------------|------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------|------------------------------|---------------|-------------------|
| format          | Формат генерируемой документации                                                                                                   | Markdown, ConfluenceMarkdown, Docusaurus | Markdown                     | format        | --format          |
| hierarchy       | Формат иерархии генерируемой документации — плоский список или иерархия по подсистемам                                             | FLAT, SUBSYSTEM                          | FLAT                         | hierarchy     | --hierarchy       |
| subsystems      | Подсистемы верхнего уровня, по которым строится документация. Если не указано, то по всем.                                          |                                          |                              | subsystems    | --only-subsystems |
| regions         | Список областей модулей, по которым строится документация. Если не указано, то по всем экспортным методам                           |                                          | ПрограммныйИнтерфейс, Public | regions       | --regions         |
| manualDocs      | Путь к каталогу с ручной документацией                                                                                             |                                          |                              | manualDocs    | --manual-docs     |
| mergeStrategy   | Способ объединения ручной и сгенерированной документации                                                                           | APPEND, REPLACE, MERGE                   | APPEND                       | mergeStrategy | --merge-strategy  |
| childLayout     | Расположение файла описания групп                                                                                                  | SUB_DIRECTORY, SAME_DIRECTORY            | SAME_DIRECTORY               | childLayout   | --child-layout    |
| header          | Шаблон, добавляется в начало каждого сгенерированного файла `{path: '', content: ''}`. Либо сам шаблон, либо путь к файлу шаблона. |                                          |                              | header        |                   |
| footer          | Шаблон, добавляется в конец каждого сгенерированного файла `{path: '', content: ''}`. Либо сам шаблон, либо путь к файлу шаблона.  |                                          |                              | footer        |                   |

### Пример запуска

```bash
bsldoc --format=Markdown --only-subsystems="ОбщегоНазначения, Администрирование" --regions="ПрограммныйИнтерфейс" source_directory output_directory
```

## Настройка `childLayout`

Определяет расположение описаний групп (подсистем).

### Пример структуры файлов

Предположим, конфигурация имеет общий модуль `СтроковыеФункции`, который относится к подсистеме `ОбщегоНазначения`.

#### Для настройки `SAME_DIRECTORY`

```tree
└── ОбщегоНазначения // Каталог с описанием элементов подсистемы
    ├── index.md // Описание подсистемы
    └── СтроковыеФункции.md // Описание общего модуля
```

#### Для настройки `SUB_DIRECTORY`

```tree
├── ОбщегоНазначения.md // Описание подсистемы
└── ОбщегоНазначения // Каталог с описанием элементов подсистемы
    └── СтроковыеФункции.md // Описание общего модуля
```

## Ручная документация

BSL-Doc поддерживает работу с ручной документацией, что позволяет:

- Совмещать ручные и сгенерированные статьи.
- Окружать сгенерированную документацию ручной в одной статье.
- Заменять сгенерированные страницы ручным вариантом.

### Процесс публикации документации

1. В каталог назначения копируется ручная документация.
2. На основании исходников генерируется документация в тот же каталог назначения.
3. При генерации проверяется существование "ручной" статьи. Если она найдена, то в зависимости от настройки `mergeStrategy`:
   - `APPEND` — соответствующее описание не генерируется, существующая страница остается неизменной.
   - `REPLACE` — страница заменяется сгенерированной.
   - `MERGE` — описания объединяются. Страница с ручной документацией может содержать маркер `generated_content`, который заменяется сгенерированным описанием. При отсутствии маркера страница остается неизменной.

## Лицензия

BSL-Doc распространяется под лицензией MIT. Подробности смотрите в файле [LICENSE](LICENSE).

## Поддержка и обратная связь

Если у вас есть вопросы, предложения или вы нашли ошибку, пожалуйста, создайте issue на [GitHub](https://github.com/1CDevFlow/BSL-Doc).
