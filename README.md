# bsldoc

## Запуск

### Параметры запуска

`bsldoc --format=<Docusaurus, Markdown> --only-subsystems=<root subsystems list> --regions=<regions filter> source destination`

* `--format` - Формат выводу (набор шаблонов генератора)
* `--hierarchy` - Формат иерархии
* `--only-subsystems` - Список подсистем, по которым строится документация.
* `--regions` - Фильтр регионов, для которых строится документация.
* `--manual-docs` - Каталог с ручной документацией, для объединения.
* `--merge-strategy` - Настройка объединения ручной и сгенерированной документации.
* `--child-layout` - Формат создания страниц групп.
* `--config` - Файл параметров команды.
* `source` - Каталог исходников.
* `destination` - Каталог выгрузки документации.

| Параметр      | Описание                                                                                                                           | Доступные значения                       | Значение по умолчанию        | Файл          | Cli               |
|---------------|------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------|------------------------------|---------------|-------------------|
| format        | Формат генерируемой документации                                                                                                   | Markdown, ConfluenceMarkdown, Docusaurus | Markdown                     | format        | --format          |
| hierarchy     | Формат иерархии генерируемой документации - плоский список, либо иерархия по подсистемам                                           | FLAT, SUBSYSTEM                          | FLAT                         | hierarchy     | --hierarchy       |
| subsystems    | Подсистемы верхнего уровня, по которым строится документация, если не указано то по всем.                                          |                                          |                              | subsystems    | --only-subsystems |
| regions       | Список областей модулей, по которые строится документация. Если не указано, то по все экспортным методам                           |                                          | ПрограммныйИнтерфейс, Public | regions       | --regions         |
| manualDocs    | Путь к каталогу с ручной документацией, подробнее ниже                                                                             |                                          | ПрограммныйИнтерфейс, Public | manualDocs    | --manual-docs     |
| mergeStrategy | Способ объединения ручной и сгенерированной документации                                                                           | APPEND, REPLACE, MERGE                   | APPEND                       | mergeStrategy | --merge-strategy  |
| childLayout   | Расположение файла описания групп                                                                                                  | SUB_DIRECTORY, SAME_DIRECTORY            | SAME_DIRECTORY               | childLayout   | --child-layout    |
| header        | Шаблон, добавляется в начало каждого сгенерированного файла `{path: '', content: ''}`. Либо сам шаблон, либо путь к файлу шаблона. |                                          |                              | header        |                   |
| footer        | Шаблон, добавляется в конец каждого сгенерированного файла `{path: '', content: ''}`. Либо сам шаблон, либо путь к файлу шаблона.  |                                          |                              | header        |                   |

#### Настройка `childLayout`

Определяет расположение описаний групп (подсистем).

Предположим конфигурация имеет общий модуль `СтроковыеФункции`, который относится к подсистеме `ОбщегоНазначения`.

* Для настройки `SAME_DIRECTORY` дерево файлов будет выглядеть
  
  ```tree
  └── ОбщегоНазначения // Каталог с описание элементов подсистемы
      ├── index.md // Описание подсистемы
      └── СтроковыеФункции.md // Описание общего модуля
  ```

* Для настройки `SUB_DIRECTORY` дерево файлов будет выглядеть
  
  ```tree
  ├── ОбщегоНазначения.md // Описание подсистемы
  └── ОбщегоНазначения // Каталог с описание элементов подсистемы
      └── СтроковыеФункции.md // Описание общего модуля
  ```

## Ручная документация

Для повышения качества документации реализована поддержка работы с ручной документацией.

Это дает вам возможность:

* Совмещать ручные и сгенерированные статьи
* Окружать сгенерированную документацию ручной в одной статье.
* Заменять сгенерированные страницы ручным вариантом.

Процесс публикации документации:

1. В каталог назначения копируется ручная документация
2. На основании исходников генерируется описания в тот же каталог назначения
3. При генерации проверяется существование "ручной" статьи, если она найдена то в зависимости от настройки `mergeStrategy`
   * `APPEND` - соответствующее описание не генерируется, существующая страница остается неизменной.
   * `REPLACE` - страница заменяется сгенерированной.
   * `MERGE` - описания объединяются, страница с ручной документацией может содержать маркер `generated_content`, маркер заменяется сгенерированным описанием.
     При отсутствии маркера станица остается неизменной.
